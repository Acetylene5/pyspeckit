

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Model Fitting &mdash; pyspeckit 0.1.9 documentation</title>
    
    <link rel="stylesheet" href="_static/extra.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/logo.ico"/>
    <link rel="top" title="pyspeckit 0.1.9 documentation" href="index.html" />
    <link rel="up" title="Features" href="features.html" />
    <link rel="next" title="Measurements" href="measurements.html" />
    <link rel="prev" title="Baseline Fitting" href="baseline.html" />
     
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setDomainName', 'pyspeckit.bitbucket.org']);
      _gaq.push(['_setAllowHash', false]);
      _gaq.push(['_trackPageview']);


    </script>
    <link rel="stylesheet" type="text/css" href="_static/extra.css" />
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="http://pyspeckit.bitbucket.org">
            <img class="logo" src="_static/logo.png" alt="Logo"/>
          </a></p>
        <h1><a href="index.html">pyspeckit 0.1.9 documentation</a></h1>
        <div class="rel">
          <a href="http://pyspeckit.bitbucket.org/">PySpecKit Home </a>  |
          <a href=index.html>Docs Home </a>  |
          <a href="https://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/overview">Bitbucket Home </a>  |
          <a href="https://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/wiki/Home">Wiki</a>  |
          <a href=search.html>Search </a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-pyspeckit.spectrum.fitters">
<span id="model-fitting"></span><h1>Model Fitting<a class="headerlink" href="#module-pyspeckit.spectrum.fitters" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="pyspeckit.spectrum.fitters.Specfit">
<em class="property">class </em><tt class="descclassname">pyspeckit.spectrum.fitters.</tt><tt class="descname">Specfit</tt><big>(</big><em>Spectrum</em>, <em>Registry=None</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">pyspeckit.spectrum.interactive.Interactive</span></tt></p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.EQW">
<tt class="descname">EQW</tt><big>(</big><em>plot=False</em>, <em>plotcolor='g'</em>, <em>fitted=True</em>, <em>continuum=None</em>, <em>components=False</em>, <em>annotate=False</em>, <em>alpha=0.5</em>, <em>loc='lower left'</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.EQW" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the equivalent width (integral of &#8220;baseline&#8221; or &#8220;continuum&#8221;
minus the spectrum) over the selected range
(the selected range is self.xmin:self.xmax, so it may include multiple lines!)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>plot</strong> : bool</p>
<blockquote>
<div><p>Plots a box indicating the EQW if plot==True (i.e., it will have a
width equal to the equivalent width, and a height equal to the
measured continuum)</p>
</div></blockquote>
<p><strong>fitted</strong> : bool</p>
<blockquote>
<div><p>Use the fitted model?  If false, uses the data</p>
</div></blockquote>
<p><strong>continuum</strong> : None or float</p>
<blockquote>
<div><p>Can specify a fixed continuum with this keyword, otherwise will use
the fitted baseline</p>
</div></blockquote>
<p><strong>components</strong> : bool</p>
<blockquote>
<div><p>If your fit is multi-component, will attempt to acquire centroids
for each component and print out individual EQWs</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first last"><strong>Equivalent Width, or widths if components=True</strong> :</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.add_sliders">
<tt class="descname">add_sliders</tt><big>(</big><em>parlimitdict=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.add_sliders" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a Sliders window in a new figure appropriately titled</p>
<dl class="docutils">
<dt><em>parlimitdict</em> [ dict ]</dt>
<dd>Each parameter needs to have displayed limits; these are set in
min-max pairs.  If this is left empty, the widget will try to guess
at reasonable limits, but the guessing is not very sophisticated
yet.</dd>
</dl>
<p><a class="reference external" href="http://stackoverflow.com/questions/4740988/add-new-navigate-modes-in-matplotlib">http://stackoverflow.com/questions/4740988/add-new-navigate-modes-in-matplotlib</a></p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.annotate">
<tt class="descname">annotate</tt><big>(</big><em>loc='upper right'</em>, <em>labelspacing=0.25</em>, <em>markerscale=0.01</em>, <em>borderpad=0.1</em>, <em>handlelength=0.1</em>, <em>handletextpad=0.1</em>, <em>frameon=False</em>, <em>chi2=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.annotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a legend to the plot showing the fitted parameters</p>
<p>_clearlegend() will remove the legend</p>
<p>chi2 : {True or &#8216;reduced&#8217; or &#8216;optimal&#8217;}</p>
<p>kwargs passed to legend</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.button3action">
<tt class="descname">button3action</tt><big>(</big><em>event</em>, <em>debug=False</em>, <em>nwidths=1</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.button3action" title="Permalink to this definition">¶</a></dt>
<dd><p>Disconnect the interactiveness
Perform the fit (or die trying)
Hide the guesses</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.clear">
<tt class="descname">clear</tt><big>(</big><em>legend=True</em>, <em>components=True</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the fitted model from the plot</p>
<p>Also removes the legend by default</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.clear_all_connections">
<tt class="descname">clear_all_connections</tt><big>(</big><em>debug=False</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.clear_all_connections" title="Permalink to this definition">¶</a></dt>
<dd><p>Prevent overlapping interactive sessions</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.clear_highlights">
<tt class="descname">clear_highlights</tt><big>(</big><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.clear_highlights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.copy">
<tt class="descname">copy</tt><big>(</big><em>parent=None</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a copy of the spectral fit - includes copies of the _full_model,
the registry, the fitter, parinfo, modelpars, modelerrs, model, npeaks</p>
<dl class="docutils">
<dt>[ parent ] </dt>
<dd>A spectroscopic axis instance that is the parent of the specfit
instance.  This needs to be specified at some point, but defaults
to None to prevent overwriting a previous plot.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.crop">
<tt class="descname">crop</tt><big>(</big><em>x1pix</em>, <em>x2pix</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.crop" title="Permalink to this definition">¶</a></dt>
<dd><p>When spectrum.crop is called, this must be too</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.downsample">
<tt class="descname">downsample</tt><big>(</big><em>factor</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.downsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Downsample the model spectrum (and the spectofit spectra)
This should only be done when Spectrum.smooth is called</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.event_manager">
<tt class="descname">event_manager</tt><big>(</big><em>event</em>, <em>debug=False</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.event_manager" title="Permalink to this definition">¶</a></dt>
<dd><p>Decide what to do given input (click, keypress, etc.)</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.firstclick_guess">
<tt class="descname">firstclick_guess</tt><big>(</big><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.firstclick_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.guesses</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.fullsizemodel">
<tt class="descname">fullsizemodel</tt><big>(</big><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.fullsizemodel" title="Permalink to this definition">¶</a></dt>
<dd><p>If the gaussian was fit to a sub-region of the spectrum,
expand it (with zeros) to fill the spectrum.</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.get_components">
<tt class="descname">get_components</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.get_components" title="Permalink to this definition">¶</a></dt>
<dd><p>If a model has been fitted, return the components of the model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><strong>kwargs are passed to self.fitter.components</strong> :</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.get_emcee">
<tt class="descname">get_emcee</tt><big>(</big><em>nwalkers=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.get_emcee" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an emcee walker ensemble for the data &amp; model using the current model type</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>data</strong> : np.ndarray</p>
<p><strong>error</strong> : np.ndarray</p>
<p><strong>nwalkers</strong> : int</p>
<blockquote class="last">
<div><p>Number of walkers to use.  Defaults to 2 * self.fitters.npars</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyspeckit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">pyspeckit</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">SpectroscopicAxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="s">&#39;km/s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="n">e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">pyspeckit</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">xarr</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">specfit</span><span class="p">(</span><span class="n">fittype</span><span class="o">=</span><span class="s">&#39;gaussian&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emcee_ensemble</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">specfit</span><span class="o">.</span><span class="n">get_emcee</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p0</span> <span class="o">=</span> <span class="n">emcee_ensemble</span><span class="o">.</span><span class="n">p0</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="o">*</span><span class="n">emcee_ensemble</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10.</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos</span><span class="p">,</span><span class="n">logprob</span><span class="p">,</span><span class="n">state</span> <span class="o">=</span> <span class="n">emcee_ensemble</span><span class="o">.</span><span class="n">run_mcmc</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.get_full_model">
<tt class="descname">get_full_model</tt><big>(</big><em>debug=False</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.get_full_model" title="Permalink to this definition">¶</a></dt>
<dd><p>compute the model over the full axis</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.get_model">
<tt class="descname">get_model</tt><big>(</big><em>xarr</em>, <em>debug=False</em>, <em>add_baseline=None</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.get_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the model over a given axis</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.get_model_frompars">
<tt class="descname">get_model_frompars</tt><big>(</big><em>xarr</em>, <em>pars</em>, <em>debug=False</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.get_model_frompars" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the model over a given axis</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.get_pymc">
<tt class="descname">get_pymc</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.get_pymc" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pymc MCMC sampler from the current fitter.  Defaults to &#8216;uninformative&#8217; priors</p>
<p><cite>kwargs</cite> are passed to the fitter&#8217;s get_pymc method, with parameters defined below.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>data</strong> : np.ndarray</p>
<p><strong>error</strong> : np.ndarray</p>
<p><strong>use_fitted_values</strong> : bool</p>
<blockquote class="last">
<div><p>Each parameter with a measured error will have a prior defined by
the Normal distribution with sigma = par.error and mean = par.value</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">pyspeckit</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">SpectroscopicAxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="s">&#39;km/s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="n">e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">pyspeckit</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">xarr</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">specfit</span><span class="p">(</span><span class="n">fittype</span><span class="o">=</span><span class="s">&#39;gaussian&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MCuninformed</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">specfit</span><span class="o">.</span><span class="n">get_pymc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MCwithpriors</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">specfit</span><span class="o">.</span><span class="n">get_pymc</span><span class="p">(</span><span class="n">use_fitted_values</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MCuninformed</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MCuninformed</span><span class="o">.</span><span class="n">stats</span><span class="p">()[</span><span class="s">&#39;AMPLITUDE0&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># WARNING: This will fail because width cannot be set &lt;0, but it may randomly reach that...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># How do you define a likelihood distribution with a lower limit?!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MCwithpriors</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MCwithpriors</span><span class="o">.</span><span class="n">stats</span><span class="p">()[</span><span class="s">&#39;AMPLITUDE0&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.guesspeakwidth">
<tt class="descname">guesspeakwidth</tt><big>(</big><em>event</em>, <em>debug=False</em>, <em>nwidths=1</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.guesspeakwidth" title="Permalink to this definition">¶</a></dt>
<dd><p>Interactively guess the peak height and width from user input</p>
<p>Width is assumed to be half-width-half-max</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.highlight_fitregion">
<tt class="descname">highlight_fitregion</tt><big>(</big><em>drawstyle='steps-mid'</em>, <em>color='g'</em>, <em>clear_highlights=True</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.highlight_fitregion" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-highlight the fitted region</p>
<p>kwargs are passed to <cite>matplotlib.plot</cite></p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.history_fitpars">
<tt class="descname">history_fitpars</tt><big>(</big><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.history_fitpars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.integral">
<tt class="descname">integral</tt><big>(</big><em>direct=False</em>, <em>threshold='auto'</em>, <em>integration_limits=</em><span class="optional">[</span><span class="optional">]</span>, <em>return_error=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the integral of the fitted spectrum</p>
<p>if direct=True, return the integral of the spectrum over a range
defined by the threshold or integration limits if defined</p>
<p>note that integration_limits will operate directly on the DATA, which means that
if you&#8217;ve baselined without subtract=True, the baseline will be included in the integral</p>
<p>if return_error is set, the error computed by
sigma = sqrt(sum(sigma_i^2)) * dx
will be returned as well</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.moments">
<tt class="descname">moments</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the moments</p>
<p>see <tt class="xref py py-mod docutils literal"><span class="pre">moments</span></tt></p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.multifit">
<tt class="descname">multifit</tt><big>(</big><em>fittype=None</em>, <em>renormalize='auto'</em>, <em>annotate=None</em>, <em>show_components=None</em>, <em>verbose=True</em>, <em>color=None</em>, <em>use_window_limits=None</em>, <em>use_lmfit=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.multifit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit multiple gaussians (or other profiles)</p>
<dl class="docutils">
<dt>fittype - What function will be fit?  fittype must have been Registryed in the</dt>
<dd>singlefitters dict.  Uses default (&#8216;gaussian&#8217;) if not specified</dd>
<dt>renormalize - if &#8216;auto&#8217; or True, will attempt to rescale small data (&lt;1e-9) to be </dt>
<dd>closer to 1 (scales by the median) so that the fit converges better</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.optimal_chi2">
<tt class="descname">optimal_chi2</tt><big>(</big><em>reduced=True</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.optimal_chi2" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute an &#8220;optimal&#8221; chi^2 statistic, i.e. one in which only pixels in
which the model is statistically significant are included</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>reduced</strong> : bool</p>
<blockquote>
<div><p>Return the reduced chi^2</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>Chi^2 statistic or reduced chi^2 statistic</strong> :</p>
<p class="last"><strong>`chi^2 = sum( (d_i - m_i)^2 / e_i^2 )</strong> :</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.peakbgfit">
<tt class="descname">peakbgfit</tt><big>(</big><em>usemoments=True</em>, <em>annotate=None</em>, <em>vheight=True</em>, <em>height=0</em>, <em>negamp=None</em>, <em>fittype=None</em>, <em>renormalize='auto'</em>, <em>color=None</em>, <em>use_lmfit=False</em>, <em>show_components=None</em>, <em>debug=False</em>, <em>nsigcut_moments=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.peakbgfit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a single peak (plus a background)</p>
<dl class="docutils">
<dt>usemoments - The initial guess will be set by the fitter&#8217;s &#8216;moments&#8217; function</dt>
<dd>(this overrides &#8216;guesses&#8217;)</dd>
</dl>
<p>annotate - Make a legend?
vheight - Fit a (constant) background as well as a peak?
height - initial guess for background
negamp - If True, assumes amplitude is negative.  If False, assumes positive.  If</p>
<blockquote>
<div>None, can be either.</div></blockquote>
<dl class="docutils">
<dt>fittype - What function will be fit?  fittype must have been Registryed in the</dt>
<dd>singlefitters dict</dd>
<dt>renormalize - if &#8216;auto&#8217; or True, will attempt to rescale small data (&lt;1e-9) to be </dt>
<dd>closer to 1 (scales by the median) so that the fit converges better</dd>
</dl>
<p>nsigcut_moments - pass to moment guesser; can do a sigma cut for moment guessing</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.plot_components">
<tt class="descname">plot_components</tt><big>(</big><em>show_hyperfine_components=None</em>, <em>component_yoffset=0.0</em>, <em>component_lw=0.75</em>, <em>component_fit_color='blue'</em>, <em>component_kwargs={}</em>, <em>add_baseline=False</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.plot_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Overplot the individual components of a fit</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>show_hyperfine_components</strong> : None | bool</p>
<blockquote class="last">
<div><blockquote>
<div><p>Keyword argument to pass to component codes; determines whether to return
individual (e.g., hyperfine) components of a composite model</p>
</div></blockquote>
<dl class="docutils">
<dt>component_yoffset <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Vertical (y-direction) offset to add to the components when plotting</p>
</dd>
<dt>component_lw <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Line width of component lines</p>
</dd>
<dt>component_fitcolor <span class="classifier-delimiter">:</span> <span class="classifier">color</span></dt>
<dd><p class="first last">Color of component lines</p>
</dd>
<dt>component_kwargs <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">Keyword arguments to pass to the fitter.components method</p>
</dd>
<dt>add_baseline <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Add the fit to the components before plotting.  Makes sense to use
if self.Spectrum.baseline.subtracted == False</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.plot_fit">
<tt class="descname">plot_fit</tt><big>(</big><em>annotate=None</em>, <em>show_components=None</em>, <em>composite_fit_color='red'</em>, <em>lw=0.5</em>, <em>composite_lw=0.75</em>, <em>use_window_limits=None</em>, <em>show_hyperfine_components=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.plot_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the fit.  Must have fitted something before calling this!</p>
<p>It will be automatically called whenever a spectrum is fit (assuming an
axis for plotting exists)</p>
<p>kwargs are passed to the fitter&#8217;s components attribute</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.plotresiduals">
<tt class="descname">plotresiduals</tt><big>(</big><em>fig=2</em>, <em>axis=None</em>, <em>clear=True</em>, <em>color='k'</em>, <em>linewidth=0.5</em>, <em>drawstyle='steps-mid'</em>, <em>yoffset=0.0</em>, <em>label=True</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.plotresiduals" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot residuals of the fit.  Specify a figure or
axis; defaults to figure(2).</p>
<p>kwargs are passed to matplotlib plot</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.print_fit">
<tt class="descname">print_fit</tt><big>(</big><em>print_baseline=True</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.print_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the best-fit parameters to the command line</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.register_fitter">
<tt class="descname">register_fitter</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.register_fitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Register a model fitter</p>
<p>Register a fitter function.</p>
<p>Required Arguments:</p>
<blockquote>
<div><dl class="docutils">
<dt><em>name</em>: [ string ]</dt>
<dd>The fit function name.</dd>
<dt><em>function</em>: [ function ]</dt>
<dd>The fitter function.  Single-fitters should take npars + 1 input
parameters, where the +1 is for a 0th order baseline fit.  They
should accept an X-axis and data and standard fitting-function
inputs (see, e.g., gaussfitter).  Multi-fitters should take N *
npars, but should also operate on X-axis and data arguments.</dd>
<dt><em>npars</em>: [ int ]</dt>
<dd>How many parameters does the function being fit accept?</dd>
</dl>
</div></blockquote>
<p>Optional Keyword Arguments:</p>
<blockquote>
<div><dl class="docutils">
<dt><em>multisingle</em>: [ &#8216;multi&#8217; | &#8216;single&#8217; ] </dt>
<dd>Is the function a single-function fitter (with a background), or
does it allow N copies of the fitting function?</dd>
<dt><em>override</em>: [ True | False ]</dt>
<dd>Whether to override any existing type if already present.</dd>
<dt><em>key</em>: [ char ]</dt>
<dd>Key to select the fitter in interactive mode</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.savefit">
<tt class="descname">savefit</tt><big>(</big><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.savefit" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the fit parameters from a Gaussian fit to the FITS header
<strong>*THESE SHOULD BE WRITTEN FOR EACH TYPE OF MODEL TO BE FIT*</strong></p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.selectregion">
<tt class="descname">selectregion</tt><big>(</big><em>xmin=None</em>, <em>xmax=None</em>, <em>xtype='wcs'</em>, <em>highlight=False</em>, <em>fit_plotted_area=True</em>, <em>reset=False</em>, <em>verbose=False</em>, <em>debug=False</em>, <em>use_window_limits=None</em>, <em>exclude=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.selectregion" title="Permalink to this definition">¶</a></dt>
<dd><p>Pick a fitting region in either WCS units or pixel units</p>
<dl class="docutils">
<dt><em>xmin / xmax</em> [ float ]</dt>
<dd>The min/max X values to use in X-axis units (or pixel units if xtype is set).
TAKES PRECEDENCE ALL OTHER BOOLEAN OPTIONS</dd>
<dt><em>xtype</em> [ string ]</dt>
<dd>A string specifying the xtype that xmin/xmax are specified in.  It can be either
&#8216;wcs&#8217; or any valid xtype from <a class="reference internal" href="units.html#module-pyspeckit.spectrum.units" title="pyspeckit.spectrum.units"><tt class="xref py py-class docutils literal"><span class="pre">pyspeckit.spectrum.units</span></tt></a></dd>
<dt><em>reset</em> [ bool ]</dt>
<dd>Reset the selected region to the full spectrum?  Only takes effect
if xmin and xmax are not (both) specified.   
TAKES PRECEDENCE ALL SUBSEQUENT BOOLEAN OPTIONS</dd>
</dl>
<p>Now things get a little complicated...
<em>fit_plotted_area</em> [ bool ]</p>
<blockquote>
<div>Use the plot limits <em>as specified in :class:`pyspeckit.spectrum.plotters`</em>?
Note that this is not necessarily the same as the window plot limits!</div></blockquote>
<dl class="docutils">
<dt><em>use_window_limits</em> [ bool ] </dt>
<dd>Use the plot limits <em>as displayed</em>.  Defaults to
<tt class="xref py py-attr docutils literal"><span class="pre">pyspeckit.spectrum.interactive.use_window_limits</span></tt>.
Overwrites xmin,xmax set by plotter</dd>
<dt>exclude: {list of length 2n,&#8217;interactive&#8217;, None}</dt>
<dd><ul class="first last simple">
<li>interactive: start an interactive session to select the
include/exclude regions</li>
<li>list: parsed as a series of (startpoint, endpoint) in the
spectrum&#8217;s X-axis units.  Will exclude the regions between
startpoint and endpoint</li>
<li>None: No exclusion</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.selectregion_interactive">
<tt class="descname">selectregion_interactive</tt><big>(</big><em>event</em>, <em>mark_include=True</em>, <em>debug=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.selectregion_interactive" title="Permalink to this definition">¶</a></dt>
<dd><p>select regions for baseline fitting</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.seterrspec">
<tt class="descname">seterrspec</tt><big>(</big><em>usestd=None</em>, <em>useresiduals=True</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.seterrspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple wrapper function to set the error spectrum; will either use the
input spectrum or determine the error using the RMS of the residuals,
depending on whether the residuals exist.</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.setfitspec">
<tt class="descname">setfitspec</tt><big>(</big><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.setfitspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the spectrum that will be fit.  This is primarily to remove NANs
from consideration: if you simply remove the data from both the X-axis
and the Y-axis, it will not be considered for the fit, and a linear
X-axis is not needed for fitting.</p>
<p>However, it may be possible to do this using masked arrays instead of
setting errors to be 1e10....</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.shift_pars">
<tt class="descname">shift_pars</tt><big>(</big><em>frame=None</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.shift_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift the velocity / wavelength / frequency of the fitted parameters
into a different frame</p>
<p>Right now this only takes care of redshift and only if redshift is defined.
It should be extended to do other things later</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.start_interactive">
<tt class="descname">start_interactive</tt><big>(</big><em>debug=False</em>, <em>LoudDebug=False</em>, <em>print_message=True</em>, <em>clear_all_connections=True</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.start_interactive" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation and Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models &amp; Fitting</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="features.html">Class Features</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="baseline.html">Baseline Fitting</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Model Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="measurements.html">Measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="units.html">Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html">Registration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="readers.html">File Readers</a></li>
<li class="toctree-l1"><a class="reference internal" href="wrappers.html">High-Level Wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactive.html">Interactive Use</a></li>
</ul>

          <h3 style="margin-top: 1.5em;">Search</h3>
          <form class="search" action="search.html" method="get">
            <input type="text" name="q" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Enter search terms or a module, class or function name.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer">
    <table width=800><tr>
            <td align=left>
      &copy; Copyright 2011, Adam Ginsburg and Jordan Mirocha.
    </td>
    <td align=right><a href="mailto:pyspeckit@gmail.com">Contact us</a></td>
    </tr>
    <tr><td>
      Last updated on Oct 27, 2012.
    </td><td align=right>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
    </td>
    <tr>
            <td align=left><a href="pyspeckit.pdf">PDF version of this document</a></td>
    </tr></table>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-6253200-7']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
        
    </div>
  </body>
</html>