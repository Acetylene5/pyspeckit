

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Model Fitting &mdash; pyspeckit 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/logo.ico"/>
    <link rel="top" title="pyspeckit 0.1 documentation" href="index.html" />
    <link rel="up" title="Features" href="features.html" />
    <link rel="next" title="Measurements" href="measurements.html" />
    <link rel="prev" title="Baseline Fitting" href="baseline.html" />
     
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setDomainName', 'pyspeckit.bitbucket.org']);
      _gaq.push(['_setAllowHash', false]);
      _gaq.push(['_trackPageview']);


    </script>
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="http://pyspeckit.bitbucket.org">
            <img class="logo" src="_static/logo.png" alt="Logo"/>
          </a></p>
        <h1><a href="index.html">pyspeckit 0.1 documentation</a></h1>
        <div class="rel">
          <a href="http://pyspeckit.bitbucket.org/">PySpecKit Home </a>  |
          <a href=index.html>Docs Home </a>  |
          <a href="https://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/overview">Bitbucket Home </a>  |
          <a href="https://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/wiki/Home">Wiki</a>  |
          <a href=search.html>Search </a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-pyspeckit.spectrum.fitters">
<span id="model-fitting"></span><h1>Model Fitting<a class="headerlink" href="#module-pyspeckit.spectrum.fitters" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="pyspeckit.spectrum.fitters.Specfit">
<em class="property">class </em><tt class="descclassname">pyspeckit.spectrum.fitters.</tt><tt class="descname">Specfit</tt><big>(</big><em>Spectrum</em>, <em>Registry=None</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.EQW">
<tt class="descname">EQW</tt><big>(</big><em>plot=False</em>, <em>plotcolor='g'</em>, <em>annotate=False</em>, <em>alpha=0.5</em>, <em>loc='lower left'</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.EQW" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the equivalent width (integral of &#8220;baseline&#8221; or &#8220;continuum&#8221;
minus the spectrum) over the selected range</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.annotate">
<tt class="descname">annotate</tt><big>(</big><em>loc='upper right'</em>, <em>labelspacing=0.25</em>, <em>markerscale=0.01</em>, <em>borderpad=0.1</em>, <em>handlelength=0.1</em>, <em>handletextpad=0.1</em>, <em>frameon=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.annotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a legend to the plot showing the fitted parameters</p>
<p>clearlegend() will remove the legend</p>
<p>kwargs passed to legend</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.clear">
<tt class="descname">clear</tt><big>(</big><em>legend=True</em>, <em>components=True</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the fitted model from the plot</p>
<p>Also removes the legend by default</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.crop">
<tt class="descname">crop</tt><big>(</big><em>x1pix</em>, <em>x2pix</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.crop" title="Permalink to this definition">¶</a></dt>
<dd><p>When spectrum.crop is called, this must be too</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.downsample">
<tt class="descname">downsample</tt><big>(</big><em>factor</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.downsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Downsample the model spectrum (and the spectofit spectra)
This should only be done when Spectrum.smooth is called</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.fullsizemodel">
<tt class="descname">fullsizemodel</tt><big>(</big><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.fullsizemodel" title="Permalink to this definition">¶</a></dt>
<dd><p>If the gaussian was fit to a sub-region of the spectrum,
expand it (with zeros) to fill the spectrum.</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.guesspeakwidth">
<tt class="descname">guesspeakwidth</tt><big>(</big><em>event</em>, <em>debug=False</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.guesspeakwidth" title="Permalink to this definition">¶</a></dt>
<dd><p>Interactively guess the peak height and width from user input</p>
<p>Width is assumed to be half-width-half-max</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.integral">
<tt class="descname">integral</tt><big>(</big><em>direct=False</em>, <em>threshold='auto'</em>, <em>integration_limits=</em><span class="optional">[</span><span class="optional">]</span>, <em>return_error=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the integral of the fitted spectrum</p>
<p>if direct=True, return the integral of the spectrum over a range
defined by the threshold or integration limits if defined</p>
<p>note that integration_limits will operate directly on the DATA, which means that
if you&#8217;ve baselined without subtract=True, the baseline will be included in the integral</p>
<p>if return_error is set, the error computed by
sigma = sqrt(sum(sigma_i^2)) * dx
will be returned as well</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.makeguess">
<tt class="descname">makeguess</tt><big>(</big><em>event</em>, <em>debug=False</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.makeguess" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>*For window-interactive use only!*</strong>
(i.e., you probably shouldn&#8217;t call this from the command line or a script)</p>
<p>Given a set of clicks or button presses, sets the fit guesses</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.makeguess_debug">
<tt class="descname">makeguess_debug</tt><big>(</big><em>event</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.makeguess_debug" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.moments">
<tt class="descname">moments</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the moments</p>
<p>see <tt class="xref py py-mod docutils literal"><span class="pre">moments</span></tt></p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.multifit">
<tt class="descname">multifit</tt><big>(</big><em>fittype=None</em>, <em>renormalize='auto'</em>, <em>annotate=None</em>, <em>color='k'</em>, <em>composite_fit_color='red'</em>, <em>component_fit_color='red'</em>, <em>lw=0.5</em>, <em>composite_lw=0.75</em>, <em>component_lw=0.75</em>, <em>show_components=None</em>, <em>verbose=True</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.multifit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit multiple gaussians (or other profiles)</p>
<dl class="docutils">
<dt>fittype - What function will be fit?  fittype must have been Registryed in the</dt>
<dd>singlefitters dict.  Uses default (&#8216;gaussian&#8217;) if not specified</dd>
<dt>renormalize - if &#8216;auto&#8217; or True, will attempt to rescale small data (&lt;1e-9) to be </dt>
<dd>closer to 1 (scales by the median) so that the fit converges better</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.peakbgfit">
<tt class="descname">peakbgfit</tt><big>(</big><em>usemoments=True</em>, <em>annotate=None</em>, <em>vheight=True</em>, <em>height=0</em>, <em>negamp=None</em>, <em>fittype=None</em>, <em>renormalize='auto'</em>, <em>color='k'</em>, <em>composite_fit_color='red'</em>, <em>component_fit_color='blue'</em>, <em>lw=1.0</em>, <em>composite_lw=1.0</em>, <em>component_lw=1.0</em>, <em>show_components=None</em>, <em>debug=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.peakbgfit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a single peak (plus a background)</p>
<dl class="docutils">
<dt>usemoments - The initial guess will be set by the fitter&#8217;s &#8216;moments&#8217; function</dt>
<dd>(this overrides &#8216;guesses&#8217;)</dd>
</dl>
<p>annotate - Make a legend?
vheight - Fit a (constant) background as well as a peak?
height - initial guess for background
negamp - If True, assumes amplitude is negative.  If False, assumes positive.  If</p>
<blockquote>
<div>None, can be either.</div></blockquote>
<dl class="docutils">
<dt>fittype - What function will be fit?  fittype must have been Registryed in the</dt>
<dd>singlefitters dict</dd>
<dt>renormalize - if &#8216;auto&#8217; or True, will attempt to rescale small data (&lt;1e-9) to be </dt>
<dd>closer to 1 (scales by the median) so that the fit converges better</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.plot_fit">
<tt class="descname">plot_fit</tt><big>(</big><em>annotate=None</em>, <em>show_components=None</em>, <em>color='k'</em>, <em>composite_fit_color='red'</em>, <em>component_fit_color='blue'</em>, <em>lw=0.5</em>, <em>composite_lw=0.75</em>, <em>component_lw=0.75</em>, <em>**component_kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.plot_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the fit.  Must have fitted something before calling this!</p>
<p>It will be automatically called whenever a spectrum is fit (assuming an
axis for plotting exists)</p>
<p>kwargs are passed to the fitter&#8217;s components attribute</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.plotresiduals">
<tt class="descname">plotresiduals</tt><big>(</big><em>fig=2</em>, <em>axis=None</em>, <em>clear=True</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.plotresiduals" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot residuals of the fit.  Specify a figure or
axis; defaults to figure(2).</p>
<p>kwargs are passed to matplotlib plot</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.register_fitter">
<tt class="descname">register_fitter</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.register_fitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Register a model fitter</p>
<p>Register a fitter function.</p>
<p>Required Arguments:</p>
<blockquote>
<div><dl class="docutils">
<dt><em>name</em>: [ string ]</dt>
<dd>The fit function name.</dd>
<dt><em>function</em>: [ function ]</dt>
<dd>The fitter function.  Single-fitters should take npars + 1 input
parameters, where the +1 is for a 0th order baseline fit.  They
should accept an X-axis and data and standard fitting-function
inputs (see, e.g., gaussfitter).  Multi-fitters should take N *
npars, but should also operate on X-axis and data arguments.</dd>
<dt><em>npars</em>: [ int ]</dt>
<dd>How many parameters does the function being fit accept?</dd>
</dl>
</div></blockquote>
<p>Optional Keyword Arguments:</p>
<blockquote>
<div><dl class="docutils">
<dt><em>multisingle</em>: [ &#8216;multi&#8217; | &#8216;single&#8217; ] </dt>
<dd>Is the function a single-function fitter (with a background), or
does it allow N copies of the fitting function?</dd>
<dt><em>override</em>: [ True | False ]</dt>
<dd>Whether to override any existing type if already present.</dd>
<dt><em>key</em>: [ char ]</dt>
<dd>Key to select the fitter in interactive mode</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.savefit">
<tt class="descname">savefit</tt><big>(</big><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.savefit" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the fit parameters from a Gaussian fit to the FITS header
<strong>*THESE SHOULD BE WRITTEN FOR EACH TYPE OF MODEL TO BE FIT*</strong></p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.selectregion">
<tt class="descname">selectregion</tt><big>(</big><em>xmin=None</em>, <em>xmax=None</em>, <em>xtype='wcs'</em>, <em>reset=False</em>, <em>debug=False</em>, <em>verbose=True</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.selectregion" title="Permalink to this definition">¶</a></dt>
<dd><p>Pick a fitting region in either WCS units or pixel units</p>
<p>reset - if true, overrides input xmin,xmax and selects the full range</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.selectregion_interactive">
<tt class="descname">selectregion_interactive</tt><big>(</big><em>event</em>, <em>debug=False</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.selectregion_interactive" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>*For window-interactive use only!*</strong>
(i.e., you probably shouldn&#8217;t call this from the command line or a script)</p>
<p>Defines the fitting region of the spectrum</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.seterrspec">
<tt class="descname">seterrspec</tt><big>(</big><em>usestd=None</em>, <em>useresiduals=True</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.seterrspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple wrapper function to set the error spectrum; will either use the
input spectrum or determine the error using the RMS of the residuals,
depending on whether the residuals exist.</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.setfitspec">
<tt class="descname">setfitspec</tt><big>(</big><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.setfitspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the spectrum that will be fit.  This is primarily to remove NANs
from consideration: if you simply remove the data from both the X-axis
and the Y-axis, it will not be considered for the fit, and a linear
X-axis is not needed for fitting.</p>
<p>However, it may be possible to do this using masked arrays instead of
setting errors to be 1e10....</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.fitters.Specfit.shift_pars">
<tt class="descname">shift_pars</tt><big>(</big><em>frame=None</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.fitters.Specfit.shift_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift the velocity / wavelength / frequency of the fitted parameters
into a different frame</p>
<p>Right now this only takes care of redshift and only if redshift is defined.
It should be extended to do other things later</p>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation and Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models &amp; Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="classes.html">Base Classes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="features.html">Class Features</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="baseline.html">Baseline Fitting</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Model Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="measurements.html">Measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="units.html">Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html">Registration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="readers.html">File Readers</a></li>
<li class="toctree-l1"><a class="reference internal" href="wrappers.html">High-Level Wrappers</a></li>
</ul>

          <h3 style="margin-top: 1.5em;">Search</h3>
          <form class="search" action="search.html" method="get">
            <input type="text" name="q" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Enter search terms or a module, class or function name.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer">
      &copy; Copyright 2011, Adam Ginsburg and Jordan Mirocha.
      Last updated on Dec 23, 2011.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre.
    <a href="pyspeckit.pdf">PDF version of this document</a>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-6253200-7']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
        
    </div>
  </body>
</html>